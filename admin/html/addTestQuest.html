<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="../css/authority/basic_layout.css" rel="stylesheet" type="text/css">
    <link href="../css/authority/common_style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css"/>
    <script type="text/javascript" src="../js/jquery/jQuery.js"></script>
    <script src="../js/update/custom.upload.js"></script>
    <link rel="stylesheet" href="../js/update/custom.upload.css">
    <script type="text/javascript" src="../js/Button_Jugement/CRDU_Button.js"></script>
    <script type="text/javascript" src="../js/Button_Jugement/Jugement_Trim_Input.js"></script>
    <style>
    .duiqi{
		float:left;
	}
    
    </style>
</head>
<body>
    <input type="hidden" name="allIDCheck" value="" id="allIDCheck"/>
    <input type="hidden" name="fangyuanEntity.fyXqName" value="" id="fyXqName"/>
    <div id="container">
        <!--<form name="form1" id="formId" method="post" action="http://localhost/math_course/common/index.php/AddQuestion/addquestion/" enctype="multipart/form-data"   onSubmit="return chkinput(this)" >-->
        <div class="ui_content">
            <div id="box_border">
                <table class="custom_addQues_content" style="height: 700px;">
                    <tr>
                        <td>試題內容<br/><span style="color: darkred">(必填項)</span></td>
                        <td>
                        <img src="../images/common/arrowleft.png" style="width: 50px; height: 100px;cursor: pointer; padding-top:43px;" class="duiqi" id="ArrowLeft" >
                        <div class="div_custom duiqi" id="div1">
                        	  <input type="button" value="+" class="col">
                              <input type="button" value="-" class="col">
                              <input type="button" value="×" class="col">
                              <input type="button" value="÷" class="col">
                              <input type="button" value="±" class="col">
                              <input type="button" value="／" class="col">
                              <input type="button" value="＝" class="col">
                              <input type="button" value="≈" class="col">
                              <input type="button" value="≠" class="col">
                              <input type="button" value="." class="col">
                              
                              <input type="button" value="π" class="col">
                              <input type="button" value="∪" class="col">
                              <input type="button" value="∩" class="col">
                              <input type="button" value="∈" class="col">
                              <input type="button" value="⊙" class="col">
                              <input type="button" value="⊥" class="col">
                              <input type="button" value="‖" class="col">
                              <input type="button" value="≌" class="col">
                              <input type="button" value="∽" class="col">
                              <input type="button" value="＜" class="col">
                              
                              <input type="button" value="＞" class="col">
                              <input type="button" value="≤" class="col">
                              <input type="button" value="≥" class="col">
                              <input type="button" value="∧" class="col">
                              <input type="button" value="△" class="col">
                              <input type="button" value="√" class="col">
                              <input type="button" value="∝" class="col">
                              <input type="button" value="∞" class="col">
                              <input type="button" value="α" class="col">
                              <input type="button" value="β" class="col">
                        </div>
                        <div style="display:none" class="div_custom duiqi dierye" id="div2">
                        	  <input type="button" value="0" class="col">
                              <input type="button" value="1" class="col">
                              <input type="button" value="2" class="col">
                              <input type="button" value="3" class="col">
                              <input type="button" value="4" class="col">
                              <input type="button" value="5" class="col">
                              <input type="button" value="6" class="col">
                              <input type="button" value="7" class="col">
                              <input type="button" value="8" class="col">
                              <input type="button" value="9" class="col">
                              
                              <input type="button" value="ω" class="col">
                              <input type="button" value="％" class="col">
                              <input type="button" value="℅" class="col">
                              <input type="button" value="°" class="col">
                              <input type="button" value="℃" class="col">
                              <input type="button" value="℉" class="col">
                              <input type="button" value="㎎" class="col">
                              <input type="button" value="㎏" class="col">
                              <input type="button" value="㎜" class="col">
                              <input type="button" value="㎝" class="col">
                              
                              <input type="button" value="㎞" class="col">
                              <input type="button" value="㎡" class="col">
                              <input type="button" value="m" class="col">
                              <input type="button" value="＄" class="col">
                              <input type="button" value="￡" class="col">
                              <input type="button" value="￥" class="col">
                              <input type="button" value="㏒" class="col">
                              <input type="button" value="㏑" class="col">
                              <input type="button" value="³" class="col">
                              <input type="button" value="ⁿ" class="col">
                        </div>
                        <img src="../images/common/arrowright.png" style="width: 60px; height: 100px;cursor: pointer; padding-top:43px; padding-left:10px;" class="duiqi" id="ArrowRight">
                        <textarea class="q_content" name="q_content" rows="8" cols="75" style="margin-left:10px; resize: none " maxlength="1005" class="bigtextarea_custom" id="innn" ></textarea></td>
                    </tr>
                    
                    <tr id="Choicequestion">
                        <td>画板<br/><p style="color: darkred">(必填項)</p></td>
                        <td>
                            <button class="button button-royal button-box button-giant" id="OpenPaint">打开画板</button>
                            <button class="button button-royal button-box button-giant" id="Refresh">刷新</button>
                            <input type="text" class="tip" name="tip" maxlength="100" style="color: red; width: 100px;"></input>
                            <input type="text" class="q_board" id="q_board" name="q_board" maxlength="1005" style="display: none;"></input>
                        </td>
                    </tr>
                    
                        <tr>
                            <td colspan="2">
                                <div class="Button_submit">
                                 <input type="submit" class="ui_input_btn03" name="ok"   value="添加">
                                </div>
                            </td>
                        </tr>
                </table>
            </div>
        <!--</form>-->
    </div>
<script src="../js/jquery/jQuery.js"></script>
<script src="../config/config.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/new_file.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>
<script src="../js/jquery/cookie.js"></script>
<script src="../js/json2.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/json_parse.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/json_parse_state.js" type="text/javascript" charset="utf-8"></script>
<script>
    $(function(){
    	var AddTestQuest = function(){
    		var result = {};
    		
    		function test(){
    			$(".tip").val('尚未添加画板！');
    			
//  			var phpid=UrlParm.parm("phpid");
//				if( phpid == undefined )
//				{
//					alert("请先登录！");
//					window.location.href = "adminLogin.html";
//				}
    		}
    		
    		function addtest(){
    			
    			var phpid = UrlParm.parm("phpid");
    			
    			
    			
    			if($(".textarea_custom").val() == "")
    			{
    				alert("请填写试题编号！");
    				return ;
    			}
    			if($(".q_content").val() == "")
    			{
    				alert("请填写试题内容！");
    				return ;
    			}
    			if($("#q_board").val() == "")
    			{
    				alert("请填写画板！");
    				return ;
    			}
    			$.ajax({
		    		type:"POST",
		    		url:'http://' + urlConfig.host + ':' + urlConfig.post + urlConfig.com + "AddQuestion/addquestion/"+"&"+"t="+Math.random(),
		    		dataType:'json',
		    		data:{
		    			"ok": "ok",
		    			"q_content": $(".q_content").val(),
		    			"board": $("#q_board").val(),
		    			"phpid" : phpid
		    		},
		    		success: function(data){
		    			if(data.code==0){
		    				alert(data.data);
		    				location.reload();
		    			}else if(data.code==200){
		    				alert("添加成功！");
		    				$.cookie('canvasData', '', { expires: -1 });
		    				location.reload();
		    			}
		    			
		    		},
		    		error: function(xml, status, error) {
		    			alert("添加失败！");
		    			console.log(error);
		    			location.reload();
		    		}
    			});
    		}
    		
    		
    		function outdata(e) {
			    var rangeStart = document.getElementById("innn").selectionStart;
				var rangeEnd=document.getElementById("innn").selectionEnd;
				var tempStr1=document.getElementById("innn").value.substring(0,rangeStart);
				var tempStr2=document.getElementById("innn").value.substring(rangeEnd);
			    var _buttonValue = this.value;
				cc=_buttonValue;
				aa=tempStr1+cc+tempStr2;
				document.getElementById("innn").value=aa;
				document.getElementById("innn").setSelectionRange(rangeEnd + 1, rangeEnd + 1);
			}
    		
    		function ArrowLeft() {
    			div1.style.display="flex";
				div2.style.display="none";
    		}
    		
    		function ArrowRight() {
    			div2.style.display="flex";
				div1.style.display="none";
    		}
    
    		result.outdata = outdata;
    		result.ArrowLeft = ArrowLeft;
    		result.ArrowRight = ArrowRight;
    		result.addtest = addtest;
    		result.test = test;
    		return result;
    	}
    	
    	
    	
    	var addTestQuest = new AddTestQuest();
    	addTestQuest.test();
    	
    	$('.ui_input_btn03').on('click', function() {
			addTestQuest.addtest();
		});
		
		$('#ArrowLeft').on('click', function() {
			addTestQuest.ArrowLeft();
		});
		
		$('#ArrowRight').on('click', function() {
			addTestQuest.ArrowRight();
		});
		
		$("#OpenPaint").on('click' , function() {
			console.log($("#q_board").val());
			var data = $("#q_board").val();
			$.cookie("RepaintData", data);  
			window.open("paint.html");
		});
		
		$("#Refresh").on('click' , function() {
			var userData = $.cookie('canvasData');
			if(userData == undefined)
			{
				alert("尚未保存画板！");
			}
			else
			{
				$(".q_board").val(userData);
				$(".tip").val('已添加画板！');
				$(".tip").css("color","green");
			}
		});
		
		$('#div1, #div2').on('click', '.col', addTestQuest.outdata);
    })
</script>
</body>
</html>
